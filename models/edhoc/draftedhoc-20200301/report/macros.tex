%\usepackage[numbers, sort]{natbib}
\usepackage[T1]{fontenc} % E.g., for small caps in section headings
\usepackage{xspace}
\usepackage{hyperref}

% -- Editorial macros
% http://tug.ctan.org/tex-archkeIVe/macros/latex/contrib/todonotes/todonotes.pdf
\usepackage{todonotes}
\newcommand{\knote}[1]{\todo[inline,
                             color=orange,
                             size=\footnotesize
                            ]{\textsf{\textbf{Karl:} #1}}}
\newcommand{\anote}[1]{\todo[inline,
                             color=orange,
                             size=\footnotesize
                            ]{\textsf{\textbf{Alessandro:} #1}}}
\newcommand{\vnote}[1]{\todo[inline,
                             color=orange,
                             size=\footnotesize
                            ]{\textsf{\textbf{Vaishnavi:} #1}}}
%\newcommand{\knote}[1]{}
%\newcommand{\vnote}[1]{}
%\newcommand{\anote}[1]{}
\newcommand{\mPoint}[1]{{\color{red}\textbf{Point: }#1}}

\newcommand{\mcneed}{\textbf{Citation needed}}
\newcommand{\mcfix}{\textbf{Fix citation}}


% -- Fonts and styles for names
\newcommand{\mItemStyle}[1]{\ensuremath{#1}}
\newcommand{\mSetStyle}[1]{\ensuremath{\mathrm{\mathbf{#1}}}}
\newcommand{\mFunStyle}[1]{\text{\textup{\textsf{#1}}}}
\newcommand{\mConstStyle}[1]{\text{\textup{\textsf{#1}}}}
\newcommand{\mVarStyle}[1]{\mathit{#1}}
\newcommand{\mFactStyle}[1]{\text{\textsf{#1}}}

\DeclareRobustCommand{\mMethodStyle}[1]{\mbox{\mConstStyle{#1}}\xspace}
\DeclareRobustCommand{\mProtocolStyle}[1]{\mbox{\textsc{#1}}}

% -- Macros for consistent wording
\newcommand{\mSpec}{specification}  % The EDHOC spec document we are analyzing


% -- Domain specific macros
\newcommand{\mArxiv}{\texttt{arXiv}\xspace}
\newcommand{\mTamarin}{\mProtocolStyle{tamarin}}
\newcommand{\mProverif}{\mProtocolStyle{proverif}}
\newcommand{\mEdhoc}{\mProtocolStyle{edhoc}}
\newcommand{\mOscore}{\mProtocolStyle{oscore}}
\newcommand{\mSigma}{\mProtocolStyle{sigma}}
\newcommand{\mSigmaI}{\mProtocolStyle{sigma-i}}
\newcommand{\mCbor}{\mProtocolStyle{cbor}}
\newcommand{\mCose}{\mProtocolStyle{cose}}
\newcommand{\mCoseEncrypt}{\mProtocolStyle{cose\_encrypt0}}
\newcommand{\mHkdf}{\mProtocolStyle{hkdf}}
\newcommand{\mHkdfExtract}{\mProtocolStyle{hkdf-extract}}
\newcommand{\mHkdfExpand}{\mProtocolStyle{hkdf-expand}}
\newcommand{\mHmac}{\mProtocolStyle{hmac}}
\newcommand{\mAead}{\mProtocolStyle{aead}}
\newcommand{\mOptls}{\mProtocolStyle{optls}}
\newcommand{\mNoise}{\mProtocolStyle{noise}}
\newcommand{\mTls}{\mProtocolStyle{tls}}
\newcommand{\mDandTls}{\mProtocolStyle{(d)tls}}
\newcommand{\mCtls}{\mProtocolStyle{ctls}}
\newcommand{\mCoap}{\mProtocolStyle{coap}}

\newcommand{\mStat}{\mMethodStyle{STAT}}
\newcommand{\mSig}{\mMethodStyle{SIG}}
\newcommand{\mPsk}{\mMethodStyle{PSK}}
\newcommand{\mStatStat}{\mMethodStyle{STAT-STAT}}
\newcommand{\mStatSig}{\mMethodStyle{STAT-SIG}}
\newcommand{\mSigStat}{\mMethodStyle{SIG-STAT}}
\newcommand{\mSigSig}{\mMethodStyle{SIG-SIG}}
\newcommand{\mPskPsk}{\mMethodStyle{PSK-PSK}}

\newcommand{\mSid}{\mConstStyle{sid}\xspace}    % session id = (u, v, s-key)

\newcommand{\mXor}{\mConstStyle{XOR}\xspace}
\newcommand{\mSuites}{\mConstStyle{Suites\_I}\xspace}
\newcommand{\mMethod}{\mConstStyle{Method}\xspace}
\newcommand{\mCi}{\mConstStyle{C\_I}\xspace}
\newcommand{\mCr}{\mConstStyle{C\_R}\xspace}
\newcommand{\mGi}{\mConstStyle{G\_I}\xspace}
\newcommand{\mGr}{\mConstStyle{G\_R}\xspace}
\newcommand{\mGiy}{\mConstStyle{G\_IY}\xspace}
\newcommand{\mGrx}{\mConstStyle{G\_RX}\xspace}
\newcommand{\mGx}{\mConstStyle{G\_X}\xspace}
\newcommand{\mGy}{\mConstStyle{G\_Y}\xspace}
\newcommand{\mGxy}{\mConstStyle{G\_XY}\xspace}
\newcommand{\mIDPsk}{\mConstStyle{ID\_PSK}\xspace}
\newcommand{\mTHtwo}{\mConstStyle{TH\_2}\xspace}
\newcommand{\mKtwoe}{\mConstStyle{K\_2e}\xspace}
\newcommand{\mKtwom}{\mConstStyle{K\_2m}\xspace}
\newcommand{\mKtwoae}{\mConstStyle{K\_2ae}\xspace}
\newcommand{\mSign}{\mConstStyle{sign}\xspace}

\newcommand{\mKthreeae}{\mConstStyle{K\_3ae}\xspace}
\newcommand{\mKthreem}{\mConstStyle{K\_3m}\xspace}

\newcommand{\mTHthree}{\mConstStyle{TH\_3}\xspace}
\newcommand{\mhplain}{\mConstStyle{h''}\xspace}
\newcommand{\mCredi}{\mConstStyle{CRED\_I}\xspace}
\newcommand{\mCredr}{\mConstStyle{CRED\_R}\xspace}
\newcommand{\mHash}{\mConstStyle{H}\xspace}

\newcommand{\mMactwo}{\mConstStyle{MAC\_2}\xspace}
\newcommand{\mMacthree}{\mConstStyle{MAC\_3}\xspace}

\newcommand{\mSigtwo}{\mConstStyle{Sig\_2}\xspace}
\newcommand{\mSigthree}{\mConstStyle{Sig\_3}\xspace}

\newcommand{\mMsgone}{\mConstStyle{m1}\xspace}
\newcommand{\mMsgtwo}{\mConstStyle{m2}\xspace}
\newcommand{\mMsgthree}{\mConstStyle{m3}\xspace}

\newcommand{\mCipher}{\mConstStyle{cipher\_2}\xspace}

\newcommand{\mADone}{\mConstStyle{AD\_1}\xspace}
\newcommand{\mADtwo}{\mConstStyle{AD\_2}\xspace}
\newcommand{\mADthree}{\mConstStyle{AD\_3}\xspace}

\newcommand{\mPRK}{\mConstStyle{PRK}\xspace}
\newcommand{\mPRKtwo}{\mConstStyle{PRK\_2e}\xspace}
\newcommand{\mPRKthree}{\mConstStyle{PRK\_3e2m}\xspace}
\newcommand{\mPRKfour}{\mConstStyle{PRK\_4x3m}\xspace}

\newcommand{\mIdcredi}{\mConstStyle{ID\_CRED\_I}\xspace}
\newcommand{\mIdcredr}{\mConstStyle{ID\_CRED\_R}\xspace}
\newcommand{\mLtki}{\mConstStyle{ltk\_I}\xspace}
\newcommand{\mLtkr}{\mConstStyle{ltk\_R}\xspace}



% TIKZ messages and actions
\newcommand{\msg}[4]{\draw[->,thick] ([yshift=-#1]#2.south) coordinate (l1)--(l1-|#3) node[midway, above]{#4}}
\newcommand{\action}[3]{\node[draw,thick,align=center,below={#1} of {#2}]{#3}}

% Tamarin symbols
\newcommand{\ifarrow}[1][]{\ifthenelse{\equal{#1}{}}{\rightarrow}{-\hspace{-3pt}[{#1}]\hspace{-3pt}\rightarrow}}
\newcommand{\semarrow}[1][]{\ifthenelse{\equal{#1}{}}{\Rightarrow}{=\hspace{-3pt}[{#1}]\hspace{-3pt}\Rightarrow}}
\newcommand{\mIn}{\mathsf{In}}
\newcommand{\mOut}{\mathsf{Out}}
\newcommand{\mKD}{\mathsf{KD}}
\newcommand{\mKU}{\mathsf{KU}}
\newcommand{\mRule}[1]{\mathit{#1}}
\newcommand{\mAeadEncrypt}{\mathit{aeadEncrypt}}
\newcommand{\mAeadDecrypt}{\mathit{aeadDecrypt}}
\newcommand{\mDecrypt}{\mathit{decrypt}}
