\usepackage{ifthen}

% -- Fonts and styles for names
\newcommand{\mFunStyle}[1]{\textsf{#1}}
\newcommand{\mConstStyle}[1]{\textsf{#1}}
\newcommand{\mVarStyle}[1]{\mathit{#1}}
\newcommand{\mFactStyle}[1]{\textsf{#1}}
\newcommand{\mMethodStyle}[1]{\mConstStyle{#1}}
\newcommand{\mProtocolStyle}[1]{\text{#1}}

% -- Macros for consistent wording
\newcommand{\mSpec}{specification}  % The EDHOC spec document we are analyzing

% -- Domain specific macros
\newcommand{\mArxiv}{\texttt{arXiv}}
\newcommand{\mTamarin}{\mProtocolStyle{Tamarin}}
\newcommand{\mProverif}{\mProtocolStyle{ProVerif}}
\newcommand{\mEdhoc}{\mProtocolStyle{EDHOC}}
\newcommand{\mOscore}{\mProtocolStyle{OSCORE}}
\newcommand{\mSigma}{\mProtocolStyle{SIGMA}}
\newcommand{\mSigmaI}{\mProtocolStyle{SIGMA\nobreakdash-I}}
\newcommand{\mCbor}{\mProtocolStyle{CBOR}}
\newcommand{\mCose}{\mProtocolStyle{COSE}}
\newcommand{\mCoseEncrypt}{\mProtocolStyle{COSE\_Encrypt0}}
\newcommand{\mCoseSign}{\mProtocolStyle{Cose\_Sign1}}
\newcommand{\mHkdf}{\mProtocolStyle{HKDF}}
\newcommand{\mHkdfExtract}{\mProtocolStyle{HKDF\nobreakdash-extract}}
\newcommand{\mHkdfExpand}{\mProtocolStyle{HKDF\nobreakdash-expand}}
\newcommand{\mHmac}{\mProtocolStyle{HMAC}}
\newcommand{\mAead}{\mProtocolStyle{AEAD}}
\newcommand{\mAeadDecrypt}{\mProtocolStyle{AEAD\nobreakdash-decrypt}}
\newcommand{\mDecrypt}{\mProtocolStyle{decrypt}}
\newcommand{\mOptls}{\mProtocolStyle{OPTLS}}
\newcommand{\mNoise}{\mProtocolStyle{Noise}}
\newcommand{\mTls}{\mProtocolStyle{TLS}}
\newcommand{\mDandTls}{\mProtocolStyle{(D)TLS}}
\newcommand{\mCtls}{\mProtocolStyle{cTLS}}
\newcommand{\mCoap}{\mProtocolStyle{CoAP}}

\newcommand{\mStat}{\mMethodStyle{STAT}}
\newcommand{\mSig}{\mMethodStyle{SIG}}
\newcommand{\mPsk}{\mMethodStyle{PSK}}
\newcommand{\mStatStat}{\mMethodStyle{STAT-STAT}}
\newcommand{\mStatSig}{\mMethodStyle{STAT-SIG}}
\newcommand{\mSigStat}{\mMethodStyle{SIG-STAT}}
\newcommand{\mSigSig}{\mMethodStyle{SIG-SIG}}
\newcommand{\mPskPsk}{\mMethodStyle{PSK-PSK}}

\newcommand{\mSid}{\mConstStyle{sid}}    % session id = (u, v, s-key)

\newcommand{\mXor}{\mConstStyle{XOR}}
\newcommand{\mSuites}{\mConstStyle{Suites\_I}}
\newcommand{\mMethod}{\mConstStyle{Method}}
\newcommand{\mCi}{\mConstStyle{C\_I}}
\newcommand{\mCr}{\mConstStyle{C\_R}}
\newcommand{\mGi}{\mConstStyle{G\_I}}
\newcommand{\mGr}{\mConstStyle{G\_R}}
\newcommand{\mGiy}{\mConstStyle{G\_IY}}
\newcommand{\mGrx}{\mConstStyle{G\_RX}}
\newcommand{\mGx}{\mConstStyle{G\_X}}
\newcommand{\mGy}{\mConstStyle{G\_Y}}
\newcommand{\mGxy}{\mConstStyle{G\_XY}}
\newcommand{\mIDPsk}{\mConstStyle{ID\_PSK}}
\newcommand{\mTH}{\mConstStyle{TH}}
\newcommand{\mTHtwo}{\mConstStyle{TH\_2}}
\newcommand{\mKtwoe}{\mConstStyle{K\_2e}}
\newcommand{\mKtwom}{\mConstStyle{K\_2m}}
\newcommand{\mKtwoae}{\mConstStyle{K\_2ae}}
\newcommand{\mSign}{\mConstStyle{sign}}

\newcommand{\mKthreeae}{\mConstStyle{K\_3ae}}
\newcommand{\mKthreem}{\mConstStyle{K\_3m}}

\newcommand{\mTHthree}{\mConstStyle{TH\_3}}
\newcommand{\mhplain}{\mConstStyle{h''}}
\newcommand{\mCredi}{\mConstStyle{CRED\_I}}
\newcommand{\mCredr}{\mConstStyle{CRED\_R}}
\newcommand{\mHash}{\mConstStyle{H}}

\newcommand{\mTHfour}{\mConstStyle{TH\_4}}
\newcommand{\mAuthi}{\mConstStyle{Auth\_I}}
\newcommand{\mAuthr}{\mConstStyle{Auth\_R}}

\newcommand{\mMactwo}{\mConstStyle{MAC\_2}}
\newcommand{\mMacthree}{\mConstStyle{MAC\_3}}

\newcommand{\mSigtwo}{\mConstStyle{Sig\_2}}
\newcommand{\mSigthree}{\mConstStyle{Sig\_3}}

\newcommand{\mMsgone}{\mConstStyle{m1}}
\newcommand{\mMsgtwo}{\mConstStyle{m2}}
\newcommand{\mMsgthree}{\mConstStyle{m3}}

\newcommand{\mCipher}{\mConstStyle{cipher\_2}}

\newcommand{\mAD}{\mConstStyle{AD}}
\newcommand{\mADone}{\mConstStyle{AD\_1}}
\newcommand{\mADtwo}{\mConstStyle{AD\_2}}
\newcommand{\mADthree}{\mConstStyle{AD\_3}}

\newcommand{\mPRK}{\mConstStyle{PRK}}
\newcommand{\mPRKtwo}{\mConstStyle{PRK\_2e}}
\newcommand{\mPRKthree}{\mConstStyle{PRK\_3e2m}}
\newcommand{\mPRKfour}{\mConstStyle{PRK\_4x3m}}

\newcommand{\mIdcredi}{\mConstStyle{ID\_CRED\_I}}
\newcommand{\mIdcredr}{\mConstStyle{ID\_CRED\_R}}
\newcommand{\mLtki}{\mConstStyle{ltk\_I}}
\newcommand{\mLtkr}{\mConstStyle{ltk\_R}}
\newcommand{\mLtk}{\mConstStyle{ltk}}

% TIKZ messages and actions
\newcommand{\msg}[4]{\draw[->,thick] ([yshift=-#1]#2.south) coordinate (l1)--(l1-|#3) node[midway, above]{#4}}
\newcommand{\action}[3]{\node[draw,thick,fill=white,align=center,below={#1} of {#2}]{#3}}

% Tamarin symbols
\newcommand{\ifarrow}[1]{\ensuremath{\mathit{\,-\hspace{-2.4pt}[{#1}]\hspace{-4.95pt}\rightarrow\,}}}
\newcommand{\semarrow}[1]{\ensuremath{\mathit{\,=\hspace{-4.9pt}[{#1}]\hspace{-5pt}\Rightarrow\,}}}
\newcommand{\mIn}{\mathsf{In}}
\newcommand{\mOut}{\mathsf{Out}}
\newcommand{\mFr}{\mathsf{Fr}}
\newcommand{\mKD}{\mathsf{KD}}
\newcommand{\mKU}{\mathsf{KU}}
\newcommand{\mT}[1]{\lstinline[basicstyle=\sffamily\normalsize]{#1}} % Tamarin code inline
\usepackage[final]{listings}

\lstdefinestyle{mystyle}{
    backgroundcolor=,   
    commentstyle=\color{Green},
    identifierstyle=\color{black},
    keywordstyle=\color{ForestGreen},
    numberstyle=\color{Gray},
    stringstyle=,
    basicstyle=\sffamily\small,
    keywords={let,in,rule,restriction,axiom,lemma,all-traces,exists-trace,Ex,All,Fr,In,Out},
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=false,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2,
    morecomment=[l]{//},
    literate=
    {=}{$=$}{1}
    {[}{$[$}{1}%
    {]}{$]$}{1}%
    {<}{$\langle$}{1}%
    {>}{$\rangle$}{1}%
    {(}{$($}{1}%
    {)}{$)$}{1}%
    {&}{$\wedge$}{1}
    {|}{$\vee$}{1}
    {$}{\$}{1}
    {<\ \#}{$<$\ \ \#}{3}% trick here: we distinguish angle brackets from temporal comparisons because of the # for the variable on the rhs
    {--[}{$\mbox{-\hspace{-4.0pt}[}$}{3}%
    {]->}{$\mbox{]\hspace{-4.2pt}\rightarrow}$}{3}%
    {-->}{$\rightarrow$}{1}
    {==>}{$\Rightarrow$}{1}
    {XOR}{$\oplus$}{1}%
    {aeadEncrypt}{\mAead{}}{6}%
    {decrypt}{\mDecrypt}{6}
    {aeadDecrypt}{\mAeadDecrypt}{11}
    {hkdfExtract}{\mHkdfExtract}{14}
    {hkdfExpand}{\mHkdfExpand}{14}
    {All\ }{$\forall$\ }{3}
    {Ex\ }{$\exists$\ }{3}
    {h(}{H$($}{2}
    {~}{{\url{~}}}{1}
    }
\lstset{style=mystyle}
